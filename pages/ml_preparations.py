import streamlit as st
import pandas as pd

class ML_prepare_viewset:
    def __init__(self):
        pass
        
    def app(self):
        st.session_state.current_page = "ML Preparations"
        
        # Page title with styling
        st.title("Machine Learning Preparations")
        st.markdown('---')
        
        # Introduction section
        st.header("ðŸ” Data Preparation")
        st.write("à¸ªà¸³à¸«à¸£à¸±à¸šà¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¹€à¸•à¸£à¸µà¸¢à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™à¸à¸²à¸£à¹€à¸—à¸£à¸™ models à¸œà¸¡à¹„à¸”à¹‰à¸„à¹‰à¸™à¸«à¸² datasets à¹ƒà¸™ kraggle à¹à¸¥à¸° archive.ics.uci.edu à¸œà¸¡à¹„à¸”à¹‰à¹€à¸¥à¸·à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ \"Census Income\"")

        # Dataset details in a collapsible section
        with st.expander("ðŸ“Š à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸Šà¸¸à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Dataset Details)"):
            col1, col2 = st.columns(2)
            with col1:
                st.write("**à¹à¸«à¸¥à¹ˆà¸‡à¸—à¸µà¹ˆà¸¡à¸²:** UCI Machine Learning Repository")
                st.write("**à¸ˆà¸³à¸™à¸§à¸™à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:** 48,842 instances")
            with col2:
                st.write("**à¸ˆà¸³à¸™à¸§à¸™à¸„à¸¸à¸“à¸¥à¸±à¸à¸©à¸“à¸°:** 14 attributes")
                st.write("**à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢:** à¸—à¸³à¸™à¸²à¸¢à¸£à¸²à¸¢à¹„à¸”à¹‰à¸¡à¸²à¸à¸à¸§à¹ˆà¸²/à¸™à¹‰à¸­à¸¢à¸à¸§à¹ˆà¸² $50K")
        
        # Model Selection section
        st.header("ðŸ¤– Model Selection")
        st.markdown("**à¹€à¸žà¸·à¹ˆà¸­à¸—à¸³à¸à¸²à¸£à¹€à¸—à¸£à¸™à¹ƒà¸™à¹‚à¸¡à¹€à¸”à¸¥ SVM** à¹€à¸žà¸·à¹ˆà¸­à¸—à¸³à¸™à¸²à¸¢à¹€à¸‡à¸´à¸™à¹€à¸”à¸·à¸­à¸™à¸ˆà¸²à¸ input à¸—à¸µà¹ˆà¸£à¸±à¸šà¸¡à¸²à¸§à¹ˆà¸²à¸ˆà¸°à¹„à¸”à¹‰à¸¡à¸²à¸à¸à¸§à¹ˆà¸²à¸£à¸²à¸¢à¹„à¸”à¹‰à¸¡à¸²à¸à¸à¸§à¹ˆà¸² 50k à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ")
        
        # Dataset features table (wider display)
        st.header("ðŸ“‹ à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸Šà¸¸à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Census Income")
        
        # Create feature data dictionary
        feature_data = {
            'à¸„à¸¸à¸“à¸¥à¸±à¸à¸©à¸“à¸°': [
                'à¸­à¸²à¸¢à¸¸ (age)', 
                'à¸›à¸£à¸°à¹€à¸ à¸—à¸à¸²à¸£à¸ˆà¹‰à¸²à¸‡à¸‡à¸²à¸™ (workclass)', 
                'à¸™à¹‰à¸³à¸«à¸™à¸±à¸à¸›à¸£à¸°à¸Šà¸²à¸à¸£ (fnlwgt)', 
                'à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸² (education)', 
                'à¸£à¸°à¸”à¸±à¸šà¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²-à¸•à¸±à¸§à¹€à¸¥à¸‚ (education-num)', 
                'à¸ªà¸–à¸²à¸™à¸ à¸²à¸žà¸ªà¸¡à¸£à¸ª (marital-status)', 
                'à¸­à¸²à¸Šà¸µà¸ž (occupation)', 
                'à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸žà¸±à¸™à¸˜à¹Œ (relationship)', 
                'à¹€à¸Šà¸·à¹‰à¸­à¸Šà¸²à¸•à¸´ (race)', 
                'à¹€à¸žà¸¨ (sex)', 
                'à¸à¸³à¹„à¸£à¸ˆà¸²à¸à¸—à¸¸à¸™ (capital-gain)', 
                'à¸‚à¸²à¸”à¸—à¸¸à¸™à¸ˆà¸²à¸à¸—à¸¸à¸™ (capital-loss)', 
                'à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡à¸—à¸³à¸‡à¸²à¸™à¸•à¹ˆà¸­à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ (hours-per-week)', 
                'à¸›à¸£à¸°à¹€à¸—à¸¨à¸—à¸µà¹ˆà¹€à¸à¸´à¸” (native-country)'
            ],
            'à¸›à¸£à¸°à¹€à¸ à¸—': [
                'à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡ (continuous)', 
                'à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ (categorical)', 
                'à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡ (continuous)', 
                'à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ (categorical)', 
                'à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡ (continuous)', 
                'à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ (categorical)', 
                'à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ (categorical)', 
                'à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ (categorical)', 
                'à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ (categorical)', 
                'à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ (categorical)', 
                'à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡ (continuous)', 
                'à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡ (continuous)', 
                'à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡ (continuous)', 
                'à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ (categorical)'
            ],
            'à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”': [
                'à¸­à¸²à¸¢à¸¸à¸‚à¸­à¸‡à¸šà¸¸à¸„à¸„à¸¥à¹€à¸›à¹‡à¸™à¸›à¸µ', 
                'à¸›à¸£à¸°à¹€à¸ à¸—à¸‚à¸­à¸‡à¸™à¸²à¸¢à¸ˆà¹‰à¸²à¸‡à¸«à¸£à¸·à¸­à¸à¸²à¸£à¸ˆà¹‰à¸²à¸‡à¸‡à¸²à¸™', 
                'à¸™à¹‰à¸³à¸«à¸™à¸±à¸à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸—à¸µà¹ˆà¸ªà¸³à¸£à¸§à¸ˆà¹‚à¸”à¸¢à¸ªà¸³à¸¡à¸°à¹‚à¸™à¸›à¸£à¸°à¸Šà¸²à¸à¸£ à¹à¸ªà¸”à¸‡à¸–à¸¶à¸‡à¸ˆà¸³à¸™à¸§à¸™à¸„à¸™à¸—à¸µà¹ˆà¸¡à¸µà¸„à¸¸à¸“à¸¥à¸±à¸à¸©à¸“à¸°à¸„à¸¥à¹‰à¸²à¸¢à¸„à¸¥à¸¶à¸‡à¸à¸±à¸™', 
                'à¸£à¸°à¸”à¸±à¸šà¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¸ªà¸¹à¸‡à¸ªà¸¸à¸”à¸—à¸µà¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ', 
                'à¸•à¸±à¸§à¹€à¸¥à¸‚à¸—à¸µà¹ˆà¹à¸—à¸™à¸£à¸°à¸”à¸±à¸šà¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸² (1-16)', 
                'à¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¸ªà¸¡à¸£à¸ªà¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™', 
                'à¸›à¸£à¸°à¹€à¸ à¸—à¸‡à¸²à¸™à¸«à¸£à¸·à¸­à¸­à¸²à¸Šà¸µà¸žà¸—à¸µà¹ˆà¸—à¸³', 
                'à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸žà¸±à¸™à¸˜à¹Œà¸ à¸²à¸¢à¹ƒà¸™à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§', 
                'à¸à¸¥à¸¸à¹ˆà¸¡à¹€à¸Šà¸·à¹‰à¸­à¸Šà¸²à¸•à¸´à¸—à¸µà¹ˆà¸£à¸°à¸šà¸¸', 
                'à¹€à¸žà¸¨à¸‚à¸­à¸‡à¸šà¸¸à¸„à¸„à¸¥', 
                'à¸£à¸²à¸¢à¹„à¸”à¹‰à¸ˆà¸²à¸à¸à¸²à¸£à¸¥à¸‡à¸—à¸¸à¸™à¸«à¸£à¸·à¸­à¸‚à¸²à¸¢à¸—à¸£à¸±à¸žà¸¢à¹Œà¸ªà¸´à¸™', 
                'à¸à¸²à¸£à¸‚à¸²à¸”à¸—à¸¸à¸™à¸ˆà¸²à¸à¸à¸²à¸£à¸¥à¸‡à¸—à¸¸à¸™à¸«à¸£à¸·à¸­à¸‚à¸²à¸¢à¸—à¸£à¸±à¸žà¸¢à¹Œà¸ªà¸´à¸™', 
                'à¸ˆà¸³à¸™à¸§à¸™à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡à¸—à¸³à¸‡à¸²à¸™à¸•à¹ˆà¸­à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ', 
                'à¸›à¸£à¸°à¹€à¸—à¸¨à¸—à¸µà¹ˆà¹€à¸à¸´à¸”à¸«à¸£à¸·à¸­à¸¡à¸µà¸ªà¸±à¸à¸Šà¸²à¸•à¸´'
            ],
            'à¸„à¹ˆà¸²à¸—à¸µà¹ˆà¹€à¸›à¹‡à¸™à¹„à¸›à¹„à¸”à¹‰': [
                'à¸•à¸±à¸§à¹€à¸¥à¸‚à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡', 
                'à¹€à¸­à¸à¸Šà¸™, à¸£à¸±à¸šà¸ˆà¹‰à¸²à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡, à¸£à¸±à¸à¸šà¸²à¸¥à¸à¸¥à¸²à¸‡, à¸£à¸±à¸à¸šà¸²à¸¥à¸—à¹‰à¸­à¸‡à¸–à¸´à¹ˆà¸™, à¸£à¸±à¸à¸šà¸²à¸¥à¸¡à¸¥à¸£à¸±à¸, à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸£à¸±à¸šà¸„à¹ˆà¸²à¸ˆà¹‰à¸²à¸‡, à¹„à¸¡à¹ˆà¹€à¸„à¸¢à¸—à¸³à¸‡à¸²à¸™', 
                'à¸•à¸±à¸§à¹€à¸¥à¸‚à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡', 
                'à¸›à¸£à¸´à¸à¸à¸²à¸•à¸£à¸µ, à¸§à¸´à¸—à¸¢à¸²à¸¥à¸±à¸¢à¸šà¸²à¸‡à¸ªà¹ˆà¸§à¸™, à¸¡à¸±à¸˜à¸¢à¸¡à¸¨à¸¶à¸à¸©à¸², à¸šà¸±à¸“à¸‘à¸´à¸•à¸§à¸´à¸Šà¸²à¸Šà¸µà¸ž, à¸­à¸™à¸¸à¸›à¸£à¸´à¸à¸à¸², à¸›à¸£à¸´à¸à¸à¸²à¹‚à¸—, à¸›à¸£à¸´à¸à¸à¸²à¹€à¸­à¸, à¸¯à¸¥à¸¯', 
                'à¸•à¸±à¸§à¹€à¸¥à¸‚à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡', 
                'à¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™, à¸«à¸¢à¹ˆà¸²à¸£à¹‰à¸²à¸‡, à¹‚à¸ªà¸”, à¹à¸¢à¸à¸à¸±à¸™à¸­à¸¢à¸¹à¹ˆ, à¸«à¸¡à¹‰à¸²à¸¢, à¸„à¸¹à¹ˆà¸ªà¸¡à¸£à¸ªà¹„à¸¡à¹ˆà¸­à¸¢à¸¹à¹ˆ', 
                'à¸ªà¸™à¸±à¸šà¸ªà¸™à¸¸à¸™à¸”à¹‰à¸²à¸™à¹€à¸—à¸„à¸™à¸´à¸„, à¸‡à¸²à¸™à¸Šà¹ˆà¸²à¸‡, à¸‡à¸²à¸™à¸šà¸£à¸´à¸à¸²à¸£, à¸‚à¸²à¸¢, à¸œà¸¹à¹‰à¸šà¸£à¸´à¸«à¸²à¸£, à¸œà¸¹à¹‰à¹€à¸Šà¸µà¹ˆà¸¢à¸§à¸Šà¸²à¸, à¹€à¸ªà¸¡à¸µà¸¢à¸™, à¹€à¸à¸©à¸•à¸£à¸à¸£à¸£à¸¡, à¸¯à¸¥à¸¯', 
                'à¸ à¸£à¸£à¸¢à¸², à¸šà¸¸à¸•à¸£, à¸ªà¸²à¸¡à¸µ, à¹„à¸¡à¹ˆà¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§, à¸à¸²à¸•à¸´à¸­à¸·à¹ˆà¸™à¹†, à¹‚à¸ªà¸”', 
                'à¸„à¸™à¸œà¸´à¸§à¸‚à¸²à¸§, à¹€à¸­à¹€à¸Šà¸µà¸¢-à¸«à¸¡à¸¹à¹ˆà¹€à¸à¸²à¸°à¹à¸›à¸‹à¸´à¸Ÿà¸´à¸, à¸­à¹€à¸¡à¸£à¸´à¸à¸±à¸™à¸­à¸´à¸™à¹€à¸”à¸µà¸¢à¸™-à¹€à¸­à¸ªà¸à¸´à¹‚à¸¡, à¸­à¸·à¹ˆà¸™à¹†, à¸„à¸™à¸œà¸´à¸§à¸”à¸³', 
                'à¸«à¸à¸´à¸‡, à¸Šà¸²à¸¢', 
                'à¸•à¸±à¸§à¹€à¸¥à¸‚à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡', 
                'à¸•à¸±à¸§à¹€à¸¥à¸‚à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡', 
                'à¸•à¸±à¸§à¹€à¸¥à¸‚à¸•à¹ˆà¸­à¹€à¸™à¸·à¹ˆà¸­à¸‡', 
                'à¸ªà¸«à¸£à¸±à¸à¸­à¹€à¸¡à¸£à¸´à¸à¸², à¸à¸±à¸¡à¸žà¸¹à¸Šà¸², à¸­à¸±à¸‡à¸à¸¤à¸©, à¹€à¸›à¸­à¸£à¹Œà¹‚à¸•à¸£à¸´à¹‚à¸, à¹à¸„à¸™à¸²à¸”à¸², à¹€à¸¢à¸­à¸£à¸¡à¸™à¸µ, à¸­à¸´à¸™à¹€à¸”à¸µà¸¢, à¸à¸µà¹ˆà¸›à¸¸à¹ˆà¸™, à¸ˆà¸µà¸™, à¹„à¸—à¸¢, à¸¯à¸¥à¸¯'
            ]
        }

        # Create DataFrame
        df_features = pd.DataFrame(feature_data)

        # Use dataframe instead of table for better width control
        st.dataframe(df_features, use_container_width=True, height=550)
        

        st.info("""
        **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸:** 
        * à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸Šà¸¸à¸”à¸™à¸µà¹‰à¹ƒà¸Šà¹‰à¸ªà¸³à¸«à¸£à¸±à¸šà¸—à¸³à¸™à¸²à¸¢à¸§à¹ˆà¸²à¸£à¸²à¸¢à¹„à¸”à¹‰à¸‚à¸­à¸‡à¸šà¸¸à¸„à¸„à¸¥à¸ˆà¸°à¸¡à¸²à¸à¸à¸§à¹ˆà¸² 50,000 à¸”à¸­à¸¥à¸¥à¸²à¸£à¹Œà¸•à¹ˆà¸­à¸›à¸µà¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ
        * à¸Šà¸¸à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸šà¹ˆà¸‡à¹€à¸›à¹‡à¸™ `adult.data` à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¹€à¸—à¸£à¸™à¹‚à¸¡à¹€à¸”à¸¥ à¹à¸¥à¸° `adult.test` à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¹‚à¸¡à¹€à¸”à¸¥
        * à¹‚à¸¡à¹€à¸”à¸¥ SVM à¸ˆà¸°à¸–à¸¹à¸à¹€à¸—à¸£à¸™à¸”à¹‰à¸§à¸¢à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸«à¸¥à¹ˆà¸²à¸™à¸µà¹‰à¹€à¸žà¸·à¹ˆà¸­à¸—à¸³à¸™à¸²à¸¢à¸£à¸°à¸”à¸±à¸šà¸£à¸²à¸¢à¹„à¸”à¹‰
        """)

        st.header("âš™ï¸ à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¹€à¸•à¸£à¸µà¸¢à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Data Preparation Process)")
        
        code_tabs = st.tabs(["1ï¸âƒ£ à¸à¸²à¸£à¸­à¹ˆà¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥", "2ï¸âƒ£ à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥", "3ï¸âƒ£ à¸à¸²à¸£à¸­à¹ˆà¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸žà¸£à¹‰à¸­à¸¡ Label"])
        
        with code_tabs[0]:
            st.code(
                """
                    # Data preprocessing steps
                    import pandas as pd
                    df = pd.read_csv('../data/income/adult.data')
                    df.shape
                """)
            
        with code_tabs[1]:
            st.code("""
                    # à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸šà¸·à¹‰à¸­à¸‡à¸•à¹‰à¸™
                    df.info()
                    df.head()
                """)
            
        with code_tabs[2]:
            st.code("""
                    # à¹€à¸™à¸·à¹ˆà¸­à¸‡à¸ˆà¸²à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¹ˆà¸­à¸™à¸«à¸™à¹‰à¸²à¹„à¸¡à¹ˆà¸¡à¸µ feature label à¸ˆà¸°à¸—à¸³à¸à¸²à¸£à¹€à¸£à¸µà¸¢à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¸¡à¹ˆà¹‚à¸”à¸¢à¹ƒà¸ªà¹ˆ feature label à¸ˆà¸²à¸ adult.name
                    def read_adult_names_file(file_path):
                        with open(file_path, 'r') as file:
                            content = file.read()
                        
                        feature_section = content.split('>50K, <=50K.')[1].strip()
                        
                        features = []
                        
                        for line in feature_section.split('\\n'):
                            if line.strip():
                                parts = line.split(': ')
                                if len(parts) == 2:
                                    feature_name = parts[0].strip()
                                    features.append(feature_name)
                        
                        features.append('income')
                        
                        return features

                    column_names = read_adult_names_file('../data/income/adult.names')
                    df = pd.read_csv('../data/income/adult.data', 
                                    header=None,  
                                    names=column_names, 
                                    sep=', ',
                                    engine='python')
                    df.head()
        """)